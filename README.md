(*)Каждый скрипт в первую очередь проверяет вендора и только при условии совпадения вендора применяет конкретные конфигурации. В каждом скрипте есть настройки для каждого вендора. В тегах хранится только желаемое/нынешнее состояние CPE.
Интерфейсы: один WAN с PPPoE, второй WAN с DHCP для связи с ACS
1. Скрипт init

Описание: CPE выходит в онлайн. У CPE нет тега BRIDGED или ROUTED. Отсутствие тегов является тригером для запуска первого скрипта провижининга. В идеале этот скрипт должен делать запрос серверу биллинга, чтобы получить желаемое состояние CPE (ROUTED или BRIDGED) и добавляет соответствующий тег к CPE.Триггером запуска скриптов является отсутствие тега ROUTED или BRIDGED соответсвенно.

Триггер: Отсутствие тега BRIDGED или ROUTED 
Действие: Запрос к серверу биллинга за информацией о желаемом типе подключения
Теги: BRIDGED или ROUTED

2. Скрипт routed

Описание: На основе тега ROUTED или BRIDGED запускаются разные скрипты провижининга. Триггером этих скриптов является наличие соответсвующего тега и отсутствие тега PROVISIONED.
Если тег ROUTED, отправляется еще один запрос на сервер биллинга, чтобы получить для PPPoE имя пользователя, пароль, wifi, lan, статические настройки и все остальное. После завершения настроек к CPE добавляется тег PROVISIONED.Описание:

Триггер: Тег ROUTED и отсутствие тега PROVISIONED
Действие: Запрос к серверу биллинга за информацией о данных для PPPoE подключения
Теги: PROVISIONED (+ ROUTED)

3.  Скрипт bridged

Описание: Если тег BRIDGED, на CPE просто включаются одни интерфейсы и отключаются другие. После завершения настроек к CPE добавляется тег PROVISIONED.

Триггер: Тег BRIDGED и отсутствие тега PROVISIONED
Действие: Включение и отключение интерфейсов
Теги: PROVISIONED (+ BRIDGED)
4. Скрипт update
Описание: Есть два сценария запуска скрипта. 1 - скрипт запускается по расписанию - 7200 секунд, начиная с 2 часов утра, при условии отсутствия перезагрузки. В этом случае в аргументы скрипту передается параметр "sheduled". Второй случай - 1 BOOT ...
Триггер: Расписание
Действие: Проверка на соответствие нужной версии и загрузка поочередная загрузка файлов при несоответствии
Теги: -
